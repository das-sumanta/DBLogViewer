<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>:::DBLog Viewer:::</title>
    <link href="css/style.css" media="screen" rel="stylesheet" type="text/css"/>
    
    <link href="css/jquery-ui.css" media="screen"  rel="stylesheet" type="text/css"/>
    <link href="css/dataTables.jqueryui.min.css" media="screen"  rel="stylesheet" type="text/css"/>
    <script  src="js/jquery-1.12.2.min.js"></script>
    <script  src="js/jquery-ui.min.js"></script>
    <script  src="js/jquery.dataTables.min.js"></script>
    <script  src="js/dataTables.jqueryui.min.js"></script>
    
    <!-- 
    <link href="https://code.jquery.com/ui/1.11.4/themes/pepper-grinder/jquery-ui.css" media="screen"  rel="stylesheet" type="text/css"/>
    <link href="https://cdn.datatables.net/1.10.11/css/dataTables.jqueryui.min.css" media="screen"  rel="stylesheet" type="text/css"/>
    <script  src="https://code.jquery.com/jquery-1.12.2.min.js" integrity="sha256-lZFHibXzMHo3GGeehn1hudTAP3Sc0uKXBXAzHX1sjtk=" crossorigin="anonymous"></script>
    <script  src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"   integrity="sha256-xNjb53/rY+WmG+4L6tTl9m6PpqknWZvRt0rO1SRnJzw="   crossorigin="anonymous"></script>
    <script  src="https://cdn.datatables.net/1.10.11/js/jquery.dataTables.min.js"></script>
    <script  src="https://cdn.datatables.net/1.10.11/js/dataTables.jqueryui.min.js"></script> -->
    <script>
      
    function validate() {
    	var runid = "";
    	var etldate = "";
    	var entity = "";
    	
    	
    	if($("#runid").val() != "")
    		{
    			runid = parseInt($("#runid").val());
    		}
    	
    	if ($("#etldate").val() != "")
    		{
    			etldate = $("#etldate").val();
    		}
    	
    	if ($("#entity").val() != "")
		{
    		entity = $("#entity").val();
		}
    	
    	if(!runid && !etldate) {
    		
    		alert("Either RunID or Date is requird !!");
    		
    	} else {
    		alert("http://" + location.hostname +":8080/DBLogViewer/rest/joblog/retrivejoblog?runid=" + runid + "&&etl_date=" + etldate + "&&enitity=" + entity);
    		$("#datatable").removeClass("hidden");
        	$( "#tabs" ).tabs();
    	    $('#table1').DataTable({
    	    	"ajax" : "http://" + location.hostname +":8080/DBLogViewer/rest/joblog/retrivejoblog?runid=" + runid + "&&etl_date=" + etldate + "&&enitity=" + entity,
    	    	//"ajax" : "retrivemsglog.txt",
    	    	"columns" : [
    				{ "data": "JobId" },
    				{ "data": "RunId" },
    				{ "data": "Entity" },
    				{ "data": "Run Mode" },
    				{ "data": "ExtractStartTime" },
    				{ "data": "ExtractEndTime" },
    				{ "data": "S3LoadStartTime" },
    				{ "data": "S3LoadEndTime" },
    				{ "data": "RedShiftLoadStart" },
    				{ "data": "RedShiftLoadEnd" },
    				{ "data": "Job Status" },
    				{ "data": "Subsidiary ID" }],
    	    	"scrollY":        "400px",
    	    	"scrollX":        "1000px"
 
    	    });
    	    $('#table2').DataTable({
    	    	"ajax" : "http://" + location.hostname +":8080/DBLogViewer/rest/joblog/retrivemsglog?runid=" + runid + "&&etl_date=" + etldate + "&&enitity=" + entity,
    	    		"columns" : [
    	    	    				{ "data": "MessageId" },
    	    	    				{ "data": "RunId" },
    	    	    				{ "data": "Message Desc" },
    	    	    				{ "data": "Target Table" },
    	    	    				{ "data": "Message Stage" },
    	    	    				{ "data": "Message Type" },
    	    	    				{ "data": "Message TimeStamp" },
    	    	    				{ "data": "Subsidiary ID" }],
    	    	    	    	"scrollY":        "400px",
    	    	    	    	"scrollX":        "1000px"
    	    });   		
    	    }
    	
    }
	  

    </script>
</head>
<body>
<div style="background-color:#92795c; color:white; padding:10px; border-radius:5px; font-family:Arial, Helvetica, sans-serif; position:relative; width:auto;" >
<form name="frm1" action="" method="post">
<table border="0" width="100%">
<tr>
<td>RunID</td>
<td><input type="text" name="txtrunid" id="runid" class="size"/></td>
<td>Entity</td>
<td><select name="entity" id="entity" class="sizenew">
		  <option value="">Select Entity</option>
		  <option value="accounting_period">Accounting Period</option>
		  <option value="accounts">Accounts</option>
		  <option value="amortization_fact">Amortization Fact</option>
		</select></td>
<td>Date</td>
<td><input type="date" name="txtdate" id="etldate" class="sizenew"/></td>
<td><input type="button" id="button1" value="Submit" class="size" onclick="validate();"/></td>
</tr>
</table>

</form>
</div>

<div class="hidden" id="datatable">

<div id="tabs">
  <ul>
    <li style="font-size:15px; font-family:Arial, Helvetica, sans-serif;"><a href="#tabs-1">Job Log</a></li>
    <li style="font-size:15px; font-family:Arial, Helvetica, sans-serif;"><a href="#tabs-2">Message Log</a></li>
   <!--  <li><a href="#tabs-3"></a></li> -->
  </ul>
  <div id="tabs-1" >
    <table id="table1" class="display"  width="100%">
        <thead>
            <tr>
                <th>JobId</th>
                <th>RunId</th>
                <th>Entity</th>
                <th>Run Mode</th>
                <th>ExtractStartTime</th>
                <th>ExtractEndTime</th>
                <th>S3LoadStartTime</th>
                <th>S3LoadEndTime</th>
                <th>RedShiftLoadStart</th>
                <th>RedShiftLoadEnd</th>
                <th>Job Status</th>
                <th>Subsidiary ID</th>
            </tr>
        </thead>
        <tfoot>
            <tr>
                <th>JobId</th>
                <th>RunId</th>
                <th>Entity</th>
                <th>Run Mode</th>
                <th>ExtractStartTime</th>
                <th>ExtractEndTime</th>
                <th>S3LoadStartTime</th>
                <th>S3LoadEndTime</th>
                <th>RedShiftLoadStart</th>
                <th>RedShiftLoadEnd</th>
                <th>Job Status</th>
                <th>Subsidiary ID</th>
            </tr>
        </tfoot>
        
    </table>
  </div>
  <div id="tabs-2">
    <table id="table2" class="display" cellspacing="0" width="100%">
        <thead>
            <tr>
                <th>MessageID</th>
                <th>RunID</th>
                <th>Message Desc</th>
                <th>Target Table</th>
                <th>Message Stage</th>
                <th>Message Type</th>
                <th>Message TimeStamp</th>
                <th>Subsidiary ID</th>
            </tr>
        </thead>
        <tfoot>
        <tr>
                <th>MessageID</th>
                <th>RunID</th>
                <th>Message Desc</th>
                <th>Target Table</th>
                <th>Message Stage</th>
                <th>Message Type</th>
                <th>Message TimeStamp</th>
                <th>Subsidiary ID</th>
            </tr>
        </tfoot>
    </table>
  </div>
</div>
</div>

</body>
</html>